<!-- 
TODO 

1. VIEW

    QUESION TEXT       QEUSTION TYPE
                       DIFFICULTY

    OOPTIONS

    ADVANCED
      DESCRIPTION

2. MULTIPLE CHOSE AND TRUE FLASE RADIO BUTTON
   AND OPTION DISPLAY STRUCTURE

    O xxxxxx   CROSS
    O xxxxxx   CROSS
    O xxxxxx   CROSS
    ADD OPTION

3. OPTION DRAG AND DROP

4. DELETE  AND DUPLICATE OPTIONS CHILD TO PARENT (at last ****)
 -->




<div *ngIf="!questionForm.get('_id')?.value">
  <form [formGroup]="questionForm" (ngSubmit)="submit()">
    <div class="question-container">
      <div class="question-text">
        <textarea rows="3" formControlName="questionText" placeholder="Question"></textarea>
        <div *ngIf="questionForm.get('questionText')?.invalid && questionForm.get('questionText')?.touched">
          Question text is required.
        </div>
      </div>
      <div>
        <select formControlName="questionType">
          <option *ngFor="let type of questionTypes" [value]="type.value">
            {{ type.display }}
          </option>
        </select>
        <div *ngIf="questionForm.get('questionType')?.invalid && questionForm.get('questionType')?.touched">
          Question type is required.
        </div>
      </div>
      <div>
        <select formControlName="difficulty">
          <option *ngFor="let difficulty of difficulties" [value]="difficulty">{{ difficulty }}</option>
        </select>
        <div *ngIf="questionForm.get('difficulty')?.invalid && questionForm.get('difficulty')?.touched">
          Difficulty is required.
        </div>
      </div>
    </div>



    <div formArrayName="options">

      <div
        *ngIf="questionForm.get('questionType')?.value === 'multipleChoice' || questionForm.get('questionType')?.value === 'multiSelect'">
        <div class="option" *ngFor="let option of options.controls; let i=index" [formGroupName]="i"
          [ngClass]="options.controls[i]?.get('isCorrect')?.value  ? 'correct-answer' : '' ">
          <input *ngIf="questionForm.get('questionType')?.value === 'multiSelect'" type="checkbox"
            formControlName="isCorrect" (change)="selectOnlyOneCorrect(i)" value="true" />
          <input *ngIf="questionForm.get('questionType')?.value === 'multipleChoice'" type="radio"
            formControlName="isCorrect" (change)="selectOnlyOneCorrect(i)" value="true" />
          <input formControlName="text" class="option-input" placeholder="option {{i+1}}" />
          <button type="button" (click)="removeOption(i)">X</button>
        </div>
        <button class="add-option-button" type="button" (click)="addOption()">Add Option</button>
      </div>

      <div formArrayName="options" *ngIf="questionForm.get('questionType')?.value === 'trueFalse'">
        <div *ngFor="let option of options.controls; let i=index" [formGroupName]="i">
          <label>{{ option.value.text }}:</label>
          <input type="checkbox" formControlName="isCorrect" (change)="selectOnlyOneCorrect(i)" value="true" /> Correct
        </div>
      </div>
      
    </div>
    <!-- <div>
      <label>Explanation:</label>
      <textarea formControlName="explanation"></textarea>
      <div *ngIf="questionForm.get('explanation')?.invalid && questionForm.get('explanation')?.touched">
        Explanation is required.
      </div>
    </div> -->



    <button type="submit" [disabled]="questionForm.invalid">Submit</button>

  </form>
</div>







<!-- question-view.component.html -->
<div class="question-view-container" *ngIf="questionForm.get('_id')?.value">

  <form [formGroup]="questionForm">

    <div class="question-header">
      <h2>{{ questionForm.get('questionText')?.value }}</h2>
      <div class="question-meta">
        <span class="question-type">{{ questionForm.get('questionType')?.value }}</span>
        <span class="question-difficulty">{{ questionForm.get('difficulty')?.value }}</span>
      </div>
    </div>

    <div class="question-options" formArrayName="options">
      <ng-container
        *ngIf="questionForm.get('questionType')?.value === 'multipleChoice' || questionForm.get('questionType')?.value === 'trueFalse'">
        <div *ngFor="let option of options.controls;let i=index" formGroupName="{{i}}">
          <label>
            <input type="radio" name="isCorrect" formControlName="isCorrect" [value]="true"
              (change)="selectOnlyOneCorrect(i)" />
            {{ option.get('text')?.value }}
          </label>
        </div>
      </ng-container>
      <ng-container *ngIf="questionForm.get('questionType')?.value === 'multiSelect'">
        <div *ngFor="let option of options?.controls;let i=index" formGroupName="{{i}}">
          <label>
            <input type="checkbox" name="isCorrect" fomControlName="isCorrect" (change)="selectOnlyOneCorrect(i)"
              [value]="true" />
            {{ option.get('text')?.value }}
          </label>
        </div>
      </ng-container>
    </div>

    <div *ngIf="false" class="advanced-options">
      <div class="explanation">
        <h3>Explanation</h3>
        <p>{{ question.explanation }}</p>
      </div>
    </div>

  </form>

</div>